<?xml version="1.0" encoding="utf-8"?>
<project xmlns="http://nant.sf.net/schemas/nant.xsd" name="InstallShield">

  <loadtasks assembly="Packages\InstallShield\bin\Nant.Contrib.BuildInstallShield.Tasks.dll"/>

  <include buildfile="InstallShield.Properties.xml"/>

  <property name="Private.InstallDirectory" value="${ProjectRootDirectory}\Current\Product\Install" />

  <target name="InstallShield.SetUp">
    
  </target>

  <target name="InstallShield.TearDown">
    
  </target>

  <target name="InstallShield.BuildSetup">
    <if test="${InstallShield.Msi}">
      <call target="InstallShield.BuildMsi" />
    </if>
    <if test="${InstallShield.InstallScript}">
      <call target="InstallShield.BuildInstallScript" />
    </if>
  </target>

  <target name="InstallShield.BuildMsi">
    <buildinstallshieldmsi
		    ismfile="${Private.InstallDirectory}\${ProjectName}\${InstallShield.IsmFile}"
		    buildguid="${InstallShield.Guid}"
		    mergemodulesearchpath="${InstallShield.Msi.MergeModuleSearchPaths}"
		    createsetupexe="${InstallShield.Msi.CreateSetupExe}"
	  />
  </target>

  <target name="InstallShield.BuildInstallScript">
    <if propertyexists="InstallShield.BuildConfigurations">
      <foreach item="String" in="${InstallShield.BuildConfigurations}" delim="," property="BuildConfig">
        <buildinstallscript
			    ismfile="${Private.InstallDirectory}\${ProjectName}\${InstallShield.IsmFile}"
			    buildguid="${InstallShield.Guid}"
          release="${BuildConfig}"
			  />
      </foreach>
    </if>
    <ifnot propertyexists="InstallShield.BuildConfigurations">
      <buildinstallscript
			    ismfile="${Private.InstallDirectory}\${ProjectName}\${InstallShield.IsmFile}"
			    buildguid="${InstallShield.Guid}"
  	    />
    </ifnot>
  </target>
</project>